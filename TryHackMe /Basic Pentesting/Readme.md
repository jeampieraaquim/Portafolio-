# Basic Pentesting
```
Creador: Johan Hammond
Direccion Ip: 10.10.33.44
Arquitectura: Linux
Dificultad: Facil
````
# Respuestas
- 1. No requiere respuesta
- 2. Escanear los puertos con nmap
- 3. development
- 4. No requiere respuesta
- 5. jan
- 6. armando
- 7. SSH 
- 8. No requiere respuesta
- 9. kay
- 10. No requiere respuesta
- 11. heresareallystrongpasswordthatfollowsthepasswordpolicy$$


### NMAP
Comando "nmap -sC -sV 10.10.33.44"

<img width="805" height="523" alt="image" src="https://github.com/user-attachments/assets/eedc1512-054c-4684-b2cf-e56d5b07ca76" />

Tenemos los puertos abiertos: 
- 22: ssh
- 80: http
- 139: smb
- 445: smb

Al tener el puerto 80 abierto, abrimos en el navegador para ver que nos encontramos

<img width="502" height="213" alt="image" src="https://github.com/user-attachments/assets/3b5d29db-7681-4e7d-94c8-1d65044cf732" />

Miramos el condigo fuente de la misma y nos encontramos que tienen un tipo de archivo "dev note" 

<img width="603" height="251" alt="image" src="https://github.com/user-attachments/assets/fcda0960-6831-48fd-b31d-d679839aa26f" />

Probamos en la url "/dev"

<img width="483" height="214" alt="image" src="https://github.com/user-attachments/assets/eadb3659-556e-4cfd-b63b-f1b33a581816" />

Y no nos indica mucho solo que trabaja en apache y su version correspondiente 
Con esto, buscaremos si hay archivos ocultos con "Gobuster" 

### Gobuster

El comando que utilizaremos es "gobuster dir -u http://10.10.33.44 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt", y estaremos pendientes si encontramos un archivo 301

<img width="815" height="341" alt="image" src="https://github.com/user-attachments/assets/ad5be330-01c4-4a5e-b94c-49e50402b981" />

Nos indica "/development" el cual probaremos en la pagina web

<img width="518" height="324" alt="image" src="https://github.com/user-attachments/assets/ad44c97b-ab9e-410b-81c5-5f166f67d5e6" />

Esto nos muestra los ficheros ocultos 

dev.txt

<img width="772" height="231" alt="image" src="https://github.com/user-attachments/assets/84a57b3d-e399-4237-8e30-407da46ddde7" />

j.txt

<img width="727" height="199" alt="image" src="https://github.com/user-attachments/assets/910ea87e-82f2-4bb5-b9f6-7edd7168626c" />

### SMB 

Ahora, pasaremos a tratar de explotar el puerto "smb" para ellos utilizaremos "enum4linux -a 10.10.33.44" 

<img width="704" height="149" alt="image" src="https://github.com/user-attachments/assets/96c2499b-404a-4fd5-bfc2-4f04ce57d1ef" />

Hemos encontrado usuarios y parece ser que son los autores de los ficheros anteriores "j: hay" y k: kay"
Y con esto pasaremos a realizar un ataque de fuerza bruta con Hydra para encontrar la contreaseña

### Hydra 
Utilizaremos el comando "hydra -l jan -P /usr/share/wordlist/rockyou.txt ssh://10.10.33.44 -t 4 -f -o hydra-ssh.txt"

<img width="768" height="102" alt="image" src="https://github.com/user-attachments/assets/4a49b66c-c30d-4025-b379-5618c154d5f5" />


En este caso el usuario es "jan" y la contraseña "armando", ahora podemos acceder 

### SSH
En este caso utilizaremos el puerto ssh ya que esta abierto con el usuario y contraseña que conseguimos en pasos anteriores
"ssh jan@10.10.33.44"

<img width="519" height="43" alt="image" src="https://github.com/user-attachments/assets/86a21de4-86c0-414a-b7ab-40dcc963c10f" />

Comprobamos que privilegios tenemos con el comando "ls -la"

<img width="467" height="168" alt="image" src="https://github.com/user-attachments/assets/6111c831-a756-467a-811c-a8263f1c9ef3" />

En este caso, solo tenemos privilegios de escritura y de lectura para ello escalaremos privilegios para tener permisos "root" o acceso a otros usuarios

# Escalada de Privilegios
Para comenzar utilizaremso el comando "cat /etc/passwd" buscaremos que usuarios existen y a que ficheros tienen acceso

<img width="784" height="743" alt="image" src="https://github.com/user-attachments/assets/4b25ad2d-3514-496d-b8f3-c978092fc0e9" />

Nos indica que hay un usuario "Jan", "Kay" y "ubuntu" con acceso a algunos archivos, pero no nos indica mucho
Por lo que pasaremos a comprobar que usuarios tienen directorios home con "ls -la /home" 

<img width="483" height="127" alt="image" src="https://github.com/user-attachments/assets/6d0f9ec6-1c9f-4da7-8549-da69a668b4ca" />

Profundizaremos en cada uno para ver que nos puede ser util

<img width="607" height="204" alt="image" src="https://github.com/user-attachments/assets/6434fc47-97cb-4dfa-b027-f17243dbc701" />

En el caso de "ubuntu" directamente nos deniega el acceso por lo que pasamos al siguiente

<img width="618" height="416" alt="image" src="https://github.com/user-attachments/assets/8ac3be40-3926-4a45-87b4-af63ed7c3e16" />

Esto es mas interesante, ya que nos deja entrar y nos muestra unos directorios que nos pueden ser utiles para escalar los privilegios

Trataremos de abrirlos con el comando "cat /home/kay/.ssh/authotized keys" y "cat /home/kay/.ssh/id_rsa" 

<img width="486" height="793" alt="image" src="https://github.com/user-attachments/assets/72e3c02e-1f4c-48d7-af47-42a947ef1a42" />

Copiaremos todo esto en un nuevo archivo con "nano kay_id_rsa" 
"Ctrol 0" para guardar y "Ctrl X" para salir
Ahora comprobaremos los permisos con el comando "chmod 600 kay_id_rsa"

<img width="462" height="54" alt="image" src="https://github.com/user-attachments/assets/1babcfec-e591-4ec0-a0f3-991358b3adf9" />

Y ahora con Jhon the Ripper procedemos a descubrir la contraseña 

# John the Ripper 
Para descubrir la contraseña primero debemos obtener el hash del archivo que copiamos en el paso anterior (id_rsa), por lo que escribiremos "python /opt/john/ssh2john.py /root/kay_is_rsa > kay_is_rsa_hash.txt"
Esto nos creara un archivo txt que podra leer JohnTheRipper

<img width="752" height="140" alt="image" src="https://github.com/user-attachments/assets/97678d2d-0bf8-43a7-a610-c958ed9ebba8" />

Lo creamos y verificamos su creacion con ls, ahora proseguimos a realizar un ataque de fuerza bruta
Para ello, escribiremos "john --wordlist=/usr/share/wordlists/rockyou.txt kay_is_rsa_hash.txt" esto nos deberia dar la contraseña oculta en el hash

<img width="805" height="268" alt="image" src="https://github.com/user-attachments/assets/c612a1a6-6c44-4d81-a6d0-8018c06df29c" />

Hemos tenido exito, ha encontrado la contraseña, para que nos muestre la misma escribiremos "john --show kay_is_rsa_hash.txt"

<img width="806" height="108" alt="image" src="https://github.com/user-attachments/assets/e098393a-329d-452b-8734-1f2ab7c20274" />

Con esto hemos conseguido el passphrase de kay y escribiremos "ssh -i kay_is_rsa kay@10.10.158.68" (Me ha cambiado la ip porque se me cerro la pagina del ejercicio)

<img width="808" height="584" alt="image" src="https://github.com/user-attachments/assets/964e83ef-8223-4cce-8594-ea8deda2b215" />

# Descubrimiento de contraseña

Una vez dentro comprobamos que archivos se encuentran disponibles con "ls", "ls -la" y verificamos si hay archivos interesantes

<img width="608" height="328" alt="image" src="https://github.com/user-attachments/assets/f8af16e7-c57f-47d9-8016-9189f7332c87" />

Abrimos el archivo "pass.back" 

<img width="516" height="60" alt="image" src="https://github.com/user-attachments/assets/7078e1dd-5554-4724-92cf-e9c62b00b28c" />

Y obtenemos la contraseña de la ultima pregunta "heresareallystrongpasswordthatfollowsthepasswordpolicy$$"
